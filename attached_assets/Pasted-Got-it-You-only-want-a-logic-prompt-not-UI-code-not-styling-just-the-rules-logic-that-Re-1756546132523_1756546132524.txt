Got it ğŸ‘ You only want a **logic prompt** (not UI code, not styling) â€” just the rules/logic that Replit should follow when building this system. Hereâ€™s a clean version:

---

# ğŸ”¹ Logic Prompt for Replit (Infra JSON Generator)

I want you to implement the **logic system** for a visual infrastructure builder.
The system uses **nodes (resources)** and **edges (dependencies)**, and outputs a **JSON definition**.

---

## ğŸ§© Node Rules

1. Each **node** represents a resource (e.g., VPC, Subnet, EC2, RDS, S3).
2. Every node has:

   * `id` â†’ unique string
   * `type` â†’ resource type (`aws_vpc`, `aws_subnet`, `aws_instance`, etc.)
   * `parent` â†’ id of its parent (if any)
   * `children` â†’ list of ids of contained resources
   * `data` â†’ resource-specific configuration (CIDR, AMI, instance\_type, etc.)

---

## ğŸ”— Edge Rules

1. Edges represent **dependencies** between resources.
2. An edge has:

   * `id` â†’ unique string
   * `source` â†’ resource id
   * `target` â†’ resource id
   * `type` â†’ always `"dependency"`
3. Dependencies define **provisioning order**:

   * Example: EC2 â†’ IAM Role means IAM Role must be created before EC2.

---

## ğŸ“ Hierarchy Rules

1. **VPC**

   * Can contain Subnets, Security Groups, Internet Gateways.
2. **Subnet**

   * Must belong to exactly one VPC.
   * Can contain EC2, RDS, ELB.
3. **Services (EC2, RDS, ELB)**

   * Must belong to a Subnet.
4. **Global Resources (S3, IAM Role)**

   * Do not require Subnet or VPC parent.
5. If a parent is deleted, all children and edges are deleted.

---

## âš™ï¸ JSON Structure

The JSON output always has two arrays:

```json
{
  "nodes": [ { "id": "...", "type": "...", "parent": "...", "children": [], "data": {} } ],
  "edges": [ { "id": "...", "source": "...", "target": "...", "type": "dependency" } ]
}
```

---

## ğŸ“ Logic Behaviors

* Adding a node creates a new JSON object in `nodes`.
* Dragging a node into a container sets its `parent` and updates `children`.
* Adding an edge creates a dependency entry in `edges`.
* Editing a node updates its `data`.
* Deleting a node removes it and its children + edges.
* Export always generates full JSON.

---

## âœ… Example

Input actions:

* Create VPC â†’ Create Subnet inside VPC â†’ Create EC2 inside Subnet â†’ Connect EC2 to IAM Role

JSON Output:

```json
{
  "nodes": [
    { "id": "vpc1", "type": "aws_vpc", "parent": null, "children": ["subnet1"], "data": {"cidr_block": "10.0.0.0/16"} },
    { "id": "subnet1", "type": "aws_subnet", "parent": "vpc1", "children": ["ec2_1"], "data": {"subnet_type": "public"} },
    { "id": "ec2_1", "type": "aws_instance", "parent": "subnet1", "children": [], "data": {"ami": "ami-123", "instance_type": "t2.micro"} },
    { "id": "iam1", "type": "aws_iam_role", "parent": null, "children": [], "data": {"role": "ec2_access"} }
  ],
  "edges": [
    { "id": "edge1", "source": "ec2_1", "target": "iam1", "type": "dependency" }
  ]
}
```

---

âš¡ Use these **rules + schema** to implement how the system manages nodes, edges, dependencies, and JSON generation.

